<!-- monitoring.wxml - å¥åº·ç›‘æµ‹æ•°æ® -->
<page-meta>
  <navigation-bar title="å¥åº·ç›‘æµ‹æ•°æ®"></navigation-bar>
</page-meta>

<view class="page-content">
  <!-- è®¾å¤‡è¿æ¥çŠ¶æ€ -->
  <view class="card device-status">
    <view class="device-status-content">
      <view class="device-status-icon" wx:if="{{healthData.deviceStatus.connected}}">
        âœ… è®¾å¤‡å·²è¿æ¥
      </view>
      <view class="device-status-icon" wx:else>
        âŒ è®¾å¤‡æœªè¿æ¥
      </view>
      <view class="device-status-info font-lg text-primary">
        ä¸Šæ¬¡åŒæ­¥ï¼š{{healthData.deviceStatus.lastSyncTime}}
      </view>
      <view class="device-status-battery font-lg text-primary">
        ç”µé‡ï¼š{{healthData.deviceStatus.battery}}%
      </view>
    </view>
    <button 
      class="btn btn-primary font-lg"
      bindtap="refreshData"
      style="margin-left: 20rpx;"
    >
      åˆ·æ–°æ•°æ®
    </button>
  </view>

  <!-- å®æ—¶å¥åº·æ•°æ® -->
  <view class="section-title font-xl font-bold text-primary">å®æ—¶å¥åº·æ•°æ®</view>
  <view class="real-time-data-grid">
    <!-- è¡€å‹ -->
    <view class="data-card aging-friendly" 
      style="background-color: {{selectedDataType === 'bloodPressure' ? 'var(--primary-light)' : 'var(--bg-primary)'}};"
      bindtap="switchDataType"
      data-type="bloodPressure"
    >
      <view class="data-label font-lg font-medium text-primary">è¡€å‹</view>
      <view class="data-value font-2xl font-bold text-primary">
        {{healthData.realTime.bloodPressure.systolic}}/{{healthData.realTime.bloodPressure.diastolic}}
      </view>
      <view class="data-unit font-lg text-secondary">{{healthData.realTime.bloodPressure.unit}}</view>
      <view class="data-status" style="color: {{healthData.realTime.bloodPressure.status === 'normal' ? '#52c41a' : (healthData.realTime.bloodPressure.status === 'warning' ? '#faad14' : '#f5222d')}};">
        {{healthData.realTime.bloodPressure.status === 'normal' ? 'æ­£å¸¸' : (healthData.realTime.bloodPressure.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
      </view>
    </view>
    
    <!-- å¿ƒç‡ -->
    <view class="data-card aging-friendly" 
      style="background-color: {{selectedDataType === 'heartRate' ? 'var(--primary-light)' : 'var(--bg-primary)'}};"
      bindtap="switchDataType"
      data-type="heartRate"
    >
      <view class="data-label font-lg font-medium text-primary">å¿ƒç‡</view>
      <view class="data-value font-2xl font-bold text-primary">
        {{healthData.realTime.heartRate.value}}
      </view>
      <view class="data-unit font-lg text-secondary">{{healthData.realTime.heartRate.unit}}</view>
      <view class="data-status" style="color: {{healthData.realTime.heartRate.status === 'normal' ? '#52c41a' : (healthData.realTime.heartRate.status === 'warning' ? '#faad14' : '#f5222d')}};">
        {{healthData.realTime.heartRate.status === 'normal' ? 'æ­£å¸¸' : (healthData.realTime.heartRate.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
      </view>
    </view>
    
    <!-- è¡€ç³– -->
    <view class="data-card aging-friendly" 
      style="background-color: {{selectedDataType === 'bloodGlucose' ? 'var(--primary-light)' : 'var(--bg-primary)'}};"
      bindtap="switchDataType"
      data-type="bloodGlucose"
    >
      <view class="data-label font-lg font-medium text-primary">è¡€ç³–</view>
      <view class="data-value font-2xl font-bold text-primary">
        {{healthData.realTime.bloodGlucose.value}}
      </view>
      <view class="data-unit font-lg text-secondary">{{healthData.realTime.bloodGlucose.unit}}</view>
      <view class="data-status" style="color: {{healthData.realTime.bloodGlucose.status === 'normal' ? '#52c41a' : (healthData.realTime.bloodGlucose.status === 'warning' ? '#faad14' : '#f5222d')}};">
        {{healthData.realTime.bloodGlucose.status === 'normal' ? 'æ­£å¸¸' : (healthData.realTime.bloodGlucose.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
      </view>
    </view>
    
    <!-- ä½“æ¸© -->
    <view class="data-card aging-friendly" 
      style="background-color: {{selectedDataType === 'temperature' ? 'var(--primary-light)' : 'var(--bg-primary)'}};"
      bindtap="switchDataType"
      data-type="temperature"
    >
      <view class="data-label font-lg font-medium text-primary">ä½“æ¸©</view>
      <view class="data-value font-2xl font-bold text-primary">
        {{healthData.realTime.temperature.value}}
      </view>
      <view class="data-unit font-lg text-secondary">{{healthData.realTime.temperature.unit}}</view>
      <view class="data-status" style="color: {{healthData.realTime.temperature.status === 'normal' ? '#52c41a' : (healthData.realTime.temperature.status === 'warning' ? '#faad14' : '#f5222d')}};">
        {{healthData.realTime.temperature.status === 'normal' ? 'æ­£å¸¸' : (healthData.realTime.temperature.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
      </view>
    </view>
  </view>

  <!-- å†å²æ•°æ® -->
  <view class="section-title font-xl font-bold text-primary">å†å²æ•°æ®</view>
  
  <!-- æ—¶é—´èŒƒå›´åˆ‡æ¢ -->
  <view class="time-range-tabs">
    <view 
      class="time-range-tab" 
      wx:for="['day', 'week', 'month']" 
      wx:key="index"
      data-range="{{item}}"
      bindtap="switchTimeRange"
      style="background-color: {{timeRange === item ? 'var(--primary-color)' : 'var(--bg-tertiary)'}}; color: {{timeRange === item ? 'white' : 'var(--text-primary)'}};"
    >
      {{item === 'day' ? 'ä»Šæ—¥' : (item === 'week' ? 'æœ¬å‘¨' : 'æœ¬æœˆ')}}
    </view>
  </view>
  
  <!-- æ•°æ®å›¾è¡¨åŒºåŸŸ -->
  <view class="chart-container card">
    <view class="chart-title font-lg font-medium text-primary">
      {{selectedDataType === 'bloodPressure' ? 'è¡€å‹' : (selectedDataType === 'heartRate' ? 'å¿ƒç‡' : (selectedDataType === 'bloodGlucose' ? 'è¡€ç³–' : 'ä½“æ¸©'))}}å†å²æ•°æ®
    </view>
    <view class="chart-placeholder">
      <view class="chart-icon">ğŸ“Š</view>
      <view class="chart-text font-lg text-secondary">
        å›¾è¡¨åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…
      </view>
      <view class="chart-subtext font-sm text-tertiary">
        å½“å‰æ˜¾ç¤º{{timeRange === 'day' ? 'ä»Šæ—¥' : (timeRange === 'week' ? 'æœ¬å‘¨' : 'æœ¬æœˆ')}}{{selectedDataType === 'bloodPressure' ? 'è¡€å‹' : (selectedDataType === 'heartRate' ? 'å¿ƒç‡' : (selectedDataType === 'bloodGlucose' ? 'è¡€ç³–' : 'ä½“æ¸©'))}}æ•°æ®
      </view>
    </view>
    
    <!-- è¡€å‹å†å²æ•°æ®åˆ—è¡¨ -->
    <view wx:if="{{selectedDataType === 'bloodPressure'}}">
      <view wx:for="{{healthData.history.bloodPressure}}" wx:key="date" class="history-item">
        <view class="history-date font-lg text-primary">{{item.date}}</view>
        <view class="history-value font-lg font-medium text-primary">
          {{item.systolic}}/{{item.diastolic}} mmHg
        </view>
        <view class="history-status" style="color: {{item.status === 'normal' ? '#52c41a' : (item.status === 'warning' ? '#faad14' : '#f5222d')}};">
          {{item.status === 'normal' ? 'æ­£å¸¸' : (item.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
        </view>
      </view>
    </view>
    
    <!-- å¿ƒç‡å†å²æ•°æ®åˆ—è¡¨ -->
    <view wx:if="{{selectedDataType === 'heartRate'}}">
      <view wx:for="{{healthData.history.heartRate}}" wx:key="date" class="history-item">
        <view class="history-date font-lg text-primary">{{item.date}}</view>
        <view class="history-value font-lg font-medium text-primary">
          {{item.value}} bpm
        </view>
        <view class="history-status" style="color: {{item.status === 'normal' ? '#52c41a' : (item.status === 'warning' ? '#faad14' : '#f5222d')}};">
          {{item.status === 'normal' ? 'æ­£å¸¸' : (item.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
        </view>
      </view>
    </view>
    
    <!-- è¡€ç³–å†å²æ•°æ®åˆ—è¡¨ -->
    <view wx:if="{{selectedDataType === 'bloodGlucose'}}">
      <view wx:for="{{healthData.history.bloodGlucose}}" wx:key="date" class="history-item">
        <view class="history-date font-lg text-primary">{{item.date}}</view>
        <view class="history-value font-lg font-medium text-primary">
          {{item.value}} mmol/L
        </view>
        <view class="history-status" style="color: {{item.status === 'normal' ? '#52c41a' : (item.status === 'warning' ? '#faad14' : '#f5222d')}};">
          {{item.status === 'normal' ? 'æ­£å¸¸' : (item.status === 'warning' ? 'è­¦å‘Š' : 'å±é™©')}}
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button 
      class="btn btn-primary font-lg"
      bindtap="viewDetailData"
      style="margin-right: 20rpx; flex: 1;"
    >
      æŸ¥çœ‹è¯¦æƒ…
    </button>
    <button 
      class="btn btn-secondary font-lg"
      bindtap="exportData"
      style="flex: 1;"
    >
      å¯¼å‡ºæ•°æ®
    </button>
  </view>
</view>
