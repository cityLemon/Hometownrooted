<!--pages/health/service-booking/service-booking.wxml-->
<page-meta>
  <navigation-bar title="æœåŠ¡é¢„çº¦"></navigation-bar>
</page-meta>

<!-- é¡µé¢åŠ è½½åŠ¨ç”» -->
<view class="page-loader {{pageLoaded ? 'hidden' : ''}}">
  <view class="loader-spinner"></view>
  <text class="loader-text">åŠ è½½ä¸­...</text>
</view>

<!-- é¡¶éƒ¨çŠ¶æ€æ å ä½ -->
<view class="status-bar-placeholder"></view>

<!-- é¡µé¢å®¹å™¨ -->
<view class="page-container" wx:if="{{pageLoaded}}">
  <!-- æœåŠ¡åˆ†ç±» -->
  <view class="service-categories">
    <view class="section-title font-xl font-bold text-primary">æœåŠ¡åˆ†ç±»</view>
    <view class="category-grid">
      <view 
        wx:for="{{serviceCategories}}" 
        wx:key="id"
        class="category-item {{selectedCategory === item.id ? 'selected' : ''}}"
        data-category="{{item.id}}"
        bindtap="selectCategory"
      >
        <view class="category-icon">{{item.icon}}</view>
        <view class="category-name font-lg font-medium text-primary">{{item.name}}</view>
      </view>
    </view>
  </view>

  <!-- å¯é¢„çº¦æœåŠ¡åˆ—è¡¨ -->
  <view class="service-list-section">
    <view class="section-title font-xl font-bold text-primary">å¯é¢„çº¦æœåŠ¡</view>
    <view wx:if="{{availableServices.length === 0}}">
      <view class="empty-text font-lg text-secondary">æš‚æ— å¯ç”¨æœåŠ¡</view>
    </view>
    <view wx:else>
      <view 
        wx:for="{{availableServices}}" 
        wx:key="id"
        class="service-item card"
        data-service="{{item}}"
        bindtap="selectService"
      >
        <view class="service-header">
          <view class="service-name font-lg font-bold text-primary">{{item.name}}</view>
          <view class="service-price font-lg font-bold text-primary">Â¥{{item.price}}</view>
        </view>
        <view class="service-description font-md text-secondary">{{item.description}}</view>
        <view class="service-info">
          <view class="service-duration font-sm text-secondary">â±ï¸ {{item.duration}}åˆ†é’Ÿ</view>
          <view class="service-provider font-sm text-secondary">ğŸ¥ {{item.provider}}</view>
        </view>
        <view class="service-rating">
          <text class="rating-stars">{{item.rating}}</text>
          <text class="rating-count font-sm text-secondary">({{item.reviewCount}}æ¡è¯„ä»·)</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„é¢„çº¦ -->
  <view class="my-bookings-section">
    <view class="section-header">
      <view class="section-title font-xl font-bold text-primary">æˆ‘çš„é¢„çº¦</view>
      <view class="view-all font-md text-primary" bindtap="viewAllBookings">æŸ¥çœ‹å…¨éƒ¨</view>
    </view>
    <view wx:if="{{myBookings.length === 0}}">
      <view class="empty-text font-lg text-secondary">æš‚æ— é¢„çº¦è®°å½•</view>
    </view>
    <view wx:else>
      <view 
        wx:for="{{myBookings}}" 
        wx:key="id"
        class="booking-item card"
        data-booking="{{item}}"
        bindtap="viewBookingDetail"
      >
        <view class="booking-header">
          <view class="booking-service font-lg font-bold text-primary">{{item.serviceName}}</view>
          <view class="booking-status font-sm {{item.status === 'confirmed' ? 'status-confirmed' : (item.status === 'pending' ? 'status-pending' : 'status-cancelled')}}">
            {{item.statusText}}
          </view>
        </view>
        <view class="booking-info">
          <view class="booking-datetime font-md text-secondary">ğŸ“… {{item.date}} {{item.time}}</view>
          <view class="booking-provider font-md text-secondary">ğŸ¥ {{item.provider}}</view>
        </view>
        <view class="booking-actions" wx:if="{{item.status === 'pending' || item.status === 'confirmed'}}">
          <button 
            class="btn btn-danger font-sm"
            data-id="{{item.id}}"
            bindtap="cancelBooking"
          >
            å–æ¶ˆé¢„çº¦
          </button>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- åº•éƒ¨å¯¼èˆª -->
<view class="bottom-nav-placeholder"></view>