# 乡村安土微信小程序

## 系统概述

乡村安土是一个专为乡村社区设计的微信小程序，提供健康管理、银龄互助、生活圈服务等功能。系统支持多角色登录（老人、志愿者、管理员、政府人员、企业CSR），每个角色享有不同的功能和服务。

## 主要功能

### 1. 用户认证系统
- **首页双击登录**：在首页任意位置双击可快速打开登录/注册页面
- **多角色注册**：支持5种角色注册（老人、志愿者、管理员、政府人员、企业CSR）
- **快速体验**：提供各角色的体验账号，方便快速测试

### 2. 老人角色功能
- **健康档案管理**：完整的健康数据记录和编辑
- **紧急呼救**：一键呼救功能，支持位置获取和SOS信息发送
- **健康监测**：实时健康数据监测和历史记录查看
- **服务预约**：医疗、生活、便民等服务预约管理

### 3. 用户状态管理
- **登录状态保持**：自动验证token有效性
- **角色切换**：在健康档案页面可切换不同角色
- **退出登录**：安全退出并清除本地存储

## 技术架构

### 前端技术
- **微信小程序**：原生小程序开发
- **UI框架**：自定义组件和样式
- **动画效果**：CSS3动画和微信小程序动画API

### 后端技术
- **Node.js + Express**：RESTful API服务
- **MySQL数据库**：用户数据、健康数据、服务数据存储
- **JWT认证**：用户身份验证和授权

### 数据库结构
- **用户表(users)**：存储用户基本信息
- **角色表(roles)**：定义系统角色类型
- **健康数据表(health_data)**：存储健康监测数据
- **服务表(services)**：存储可预约服务信息
- **预约表(appointments)**：存储用户预约记录

## 快速开始

### 1. 数据库配置
```sql
-- 执行数据库初始化脚本
cd database
mysql -u root -p < schema.sql
```

### 2. 后端服务启动
```bash
cd backend
npm install
npm start
```

### 3. 微信小程序配置
- 在微信开发者工具中导入项目
- 配置合法域名：http://localhost:3000
- 编译并预览小程序

## 使用说明

### 登录注册
1. **首页双击**：在首页任意位置双击打开登录选项
2. **选择操作**：选择"登录账号"或"注册账号"
3. **快速体验**：使用提供的体验账号快速登录

### 老人角色使用
1. **进入健康档案**：登录后自动跳转到健康档案页面
2. **快捷功能**：顶部有紧急呼救、健康监测、服务预约、用户菜单
3. **用户菜单**：点击用户菜单可切换角色或退出登录

### 角色切换
1. **用户菜单**：在健康档案页面点击"用户菜单"
2. **切换角色**：选择"切换角色"返回首页重新选择
3. **退出登录**：选择"退出登录"安全退出系统

## API接口文档

### 认证相关
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/validate` - Token验证

### 用户相关
- `GET /api/users/profile` - 获取用户信息
- `PUT /api/users/profile` - 更新用户信息

### 健康数据
- `GET /api/health/data` - 获取健康数据
- `POST /api/health/data` - 添加健康数据

### 服务预约
- `GET /api/services` - 获取服务列表
- `POST /api/appointments` - 创建预约
- `GET /api/appointments` - 获取预约记录

## 开发规范

### 前端规范
- 使用语义化的类名和ID
- 遵循微信小程序开发规范
- 保持代码整洁和可读性

### 后端规范
- RESTful API设计原则
- 统一的响应格式
- 完善的错误处理机制

### 数据库规范
- 使用有意义的表名和字段名
- 添加必要的索引提高查询性能
- 保持数据完整性和一致性

## 安全说明

### 数据安全
- 用户密码使用bcrypt加密存储
- JWT token设置合理的过期时间
- 敏感数据传输使用HTTPS协议

### 隐私保护
- 用户位置信息仅在紧急情况下使用
- 健康数据严格保密，仅用户本人和授权人员可查看
- 遵循相关隐私保护法律法规

## 更新日志

### v1.0.0 (2024-12-06)
- ✅ 完成用户认证系统
- ✅ 实现老人角色核心功能
- ✅ 添加健康档案管理
- ✅ 支持多角色登录和切换
- ✅ 完成服务预约功能

## 联系方式

如有问题或建议，请通过以下方式联系：
- 邮箱：support@rural-community.com
- 电话：400-123-4567

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。